<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Would You Rather</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#699eb0" />

  <style>
    body {
      background: #fff9f3; /* light warm cream */
      font-family: 'Poppins', sans-serif;
      text-align: center;
      padding: 2rem;
      color: #3c3c3c; /* warm soft charcoal */
      margin: 0;
    }
    .logo { max-width: 150px; margin-bottom: 1rem; }
    h1 {
      color: #127490; /* teal/blue */
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-size: 1.6rem;
    }
    #prompt {
      margin: 2rem auto;
      font-size: 1.25rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      border: 2px dashed #f8b934; /* yellow */
      max-width: 90%;
      min-height: 120px;
      backdrop-filter: blur(6px);
    }
    .btns { display:flex; gap:.5rem; justify-content:center; flex-wrap:wrap; }
    button {
      background-color: #b24627; /* orange/red */
      color: white;
      border: none;
      padding: 1rem 1.2rem;
      border-radius: 30px;
      font-size: 1.05rem;
      cursor: pointer;
      margin-top: 1rem;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
    }
    button:hover { background-color: #c95e3c; }
    button[disabled]{opacity:.5; cursor:not-allowed;}

    .btn-secondary{
      background:#ffe9d6; color:#6b3a28;
    }
    .btn-secondary:hover{ background:#ffdcbf; }

    .cover {
      margin-top: 2rem;
      width: 250px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    /* One-time courtesy overlay (unchanged) */
    #courtesyOverlay {
      position: fixed; inset: 0;
      background: rgba(0,0,0,.4);
      display: none; place-items: center;
      z-index: 9999; opacity: 1; transition: opacity .3s ease;
    }
    .courtesy-card {
      width: min(560px, 92%);
      background: #fff;
      color: #3c3c3c;
      border-radius: 18px;
      box-shadow: 0 12px 40px rgba(0,0,0,.18);
      padding: 22px;
      text-align: left;
    }
    .courtesy-card h2 { margin: 0 0 8px; color: #127490; font-size: 20px; }
    .courtesy-card p { margin: 6px 0 14px; color: #666; }
    .courtesy-check { display:flex; align-items:center; gap:10px; margin: 6px 0 12px; }
    #courtesyContinue {
      width: 100%; padding: 12px 14px; border: 0;
      border-radius: 14px; font-weight: 700; cursor: pointer;
      background: #b24627; color: #fff;
      box-shadow: 0 4px 14px rgba(0,0,0,.08);
    }
    #courtesyContinue:disabled { opacity: .5; cursor: not-allowed; }

    footer {
      font-size: 0.9rem; color: #777;
      margin-top: 3rem; max-width: 90%;
      margin-left: auto; margin-right: auto;
    }

    /* Favorites area */
    #favWrap{ max-width:860px; margin:2rem auto 0; text-align:left; }
    #favHeader{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
    #favHeader h3{ margin:0; color:#7a3e2e; font-size:1.1rem; }
    #favList{
      list-style:none; padding:0; margin:12px 0 0;
      display:grid; grid-template-columns:1fr; gap:10px;
    }
    .favItem{
      background:#fff; border:1px solid #ffdcbf; border-radius:14px; padding:12px 14px;
      display:flex; justify-content:space-between; align-items:flex-start; gap:12px;
      box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    .favText{ font-size:.98rem; line-height:1.35rem; }
    .favActions{ display:flex; gap:8px; flex-shrink:0; }
    .iconBtn{
      border:0; background:#ffe9d6; color:#6b3a28; padding:.45rem .7rem; border-radius:10px; font-size:.9rem; cursor:pointer;
    }
    .iconBtn:hover{ background:#ffdcbf; }
    .muted{ color:#6b7f88; font-size:.9rem; }

    /* Tiny toast */
    #toast{
      position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
      background:#127490; color:#fff; padding:10px 14px; border-radius:12px;
      box-shadow:0 8px 24px rgba(0,0,0,.18); opacity:0; pointer-events:none;
      transition:opacity .25s ease, transform .25s ease;
      font-size:.95rem;
    }
    #toast.show{ opacity:1; transform:translateX(-50%) translateY(-4px); }
  </style>
</head>
<body>

  <!-- One-time courtesy reminder overlay -->
  <section id="courtesyOverlay" role="dialog" aria-labelledby="courtesyTitle" aria-modal="true">
    <div class="courtesy-card">
      <h2 id="courtesyTitle">Thanks for supporting this work</h2>
      <p>Please do not share this link.</p>

      <label class="courtesy-check">
        <input type="checkbox" id="courtesyAck" />
        <span>I understand — got it!</span>
      </label>

      <button id="courtesyContinue" disabled>Continue</button>
    </div>
  </section>

  <!-- App content -->
  <div id="generator">
    <img src="https://www.dropbox.com/scl/fi/bxxozomo7t9nxhog8kbt9/WYRgraphic.png?rlkey=qswgg970yapmsjkp0slkqjdov&st=o5kf3lel&raw=1" alt="WYR PHP logo" class="logo" />
    <h1>WOULD YOU RATHER...? from Playful Heart Parenting</h1>

    <div class="btns">
      <button id="btnNext">Would you rather…</button>
      <button id="btnBack">Back</button>
      <button id="btnFwd">Forward</button>
      <button id="btnSave" class="btn-secondary">Save to Favorites</button>
    </div>

    <div id="prompt">Tap the button to get a "Would You Rather" question! For extra fun, explain your answer!</div>

    <footer>
      © 2025 Mia Wisinski, Playful Heart Parenting. This app is for personal use only by those who have purchased <em>Would You Rather</em> from Playful Heart Parenting. Please do not share this link publicly or distribute without explicit permission.
    </footer>

    <div style="margin-top: 2rem;">
      <h2>Submit Your Own!</h2>
      <p style="font-size: 1rem; max-width: 600px; margin: 0 auto;">
        Got a funny or creative Would You Rather idea? We’d love to hear it! Click below to submit — we may feature it in a future update and credit your first name.
      </p>
      <button onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLScUKjXC-tbLy-BRjFXl8EwEvs9i1OYOlQZqMqX1QeVsvnlaAQ/viewform', '_blank')" style="margin-top: 1rem;">
        Submit Your Idea
      </button>
    </div>
  </div>

  <!-- Favorites list -->
  <section id="favWrap" aria-labelledby="favTitle">
    <div id="favHeader">
      <h3 id="favTitle">Favorites</h3>
      <div class="btns" style="margin-top:0;">
        <button class="btn-secondary" id="btnCopyAll">Copy All</button>
        <button class="btn-secondary" id="btnClear">Clear</button>
      </div>
    </div>
    <p class="muted" id="favEmpty">No favorites yet. Save any you love.</p>
    <ul id="favList"></ul>
  </section>

  <!-- Tiny toast -->
  <div id="toast" role="status" aria-live="polite"></div>

  <script>
    /* One-time courtesy reminder (unchanged) */
    (function(){
      const COURTESY_KEY = 'wyr_courtesy_v1';
      const overlay = document.getElementById('courtesyOverlay');
      const ack     = document.getElementById('courtesyAck');
      const goBtn   = document.getElementById('courtesyContinue');

      if (localStorage.getItem(COURTESY_KEY) !== 'yes') {
        overlay.style.display = 'grid';
        ack.addEventListener('change', ()=>{ goBtn.disabled = !ack.checked; });
        goBtn.addEventListener('click', ()=>{
          localStorage.setItem(COURTESY_KEY, 'yes');
          overlay.style.opacity = '0';
          setTimeout(()=>{ overlay.style.display='none'; overlay.style.opacity='1'; }, 320);
        });
      }
    })();

    /* Prompts (your existing list) */
    const prompts = [
      "Would you rather have to eat a handful of jelly beans every hour on the hour (even setting an alarm to wake through the night) or legally change your name to Jelly Bean [Your Last Name]?",
      "Would you rather sleep in a giant flower or have the magical ability to grow flowers wherever you walk?",
      "Would you rather be able to control the weather with your mind or move objects with your mind?",
      "Would you rather have a little alarm bell automatically go off every time you fart or have your farts be bright colored puffs of air so everybody knows it was you?",
      "Would you rather drink a pizza flavored smoothie or eat a smoothie flavored pizza?",
      "Would you rather dance everywhere you went or have to sing everything you say?",
      "Would you rather have a little parrot that lives on your shoulder all the time and interrupts you constantly or a little squirrel friend that lives in your pocket and is constantly filling it with little nuts and rocks and other treasures?",
      "Would you rather have to communicate for a whole day by mooing like a cow or by clucking like a hen?",
      "Would you rather have a magic mug that refills itself with your favorite beverage whenever you blink four times in a row or a magical snack bag that refills itself with your favorite snacks anytime you snapped your fingers three times in a row?",
      "Would you rather have the song wheels on the bus stuck in your head on a loop forever day and night or have to sing the entire wheels on the bus song every time you meet someone new out loud right after you say your first name?",
      "Would you rather be able to lift anything in the world no matter how heavy it is or outrun anything in the world no matter how fast it is?",
      "Would you rather be able to breathe underwater or fly?",
      "Would you rather be able to communicate with animals or read other humans’ minds?",
      "Would you rather have a live marching band wake you up in your room every morning at 6 AM or have a live marching band play you lullabies as they marched around your room at bedtime every night?",
      "Would you rather have a dog tail wag every time you’re happy or cat ears that twitch every time you’re curious?",
      "Would you rather have built-in wheels on your feet or built-in headlights on your forehead?",
      "Would you rather get around everywhere by riding on a magic flying carpet or by riding on a magic flying unicorn?",
      "Would you rather have the magic ability to make anything you draw come to life or anything you wish come true as long as this power can only be used for good and joy?",
      "Would you rather be able to travel back in time to the past or travel forward in time into the future?",
      "Would you rather have to sleep in a giant bird nest or in a giant clamshell?",
      "Would you rather have smoke come out of your ears when you’re mad or bubbles come out of your nose when you’re feeling amused?",
      "Would you rather have to wear an outfit made out of wet, toilet paper or out of chewed up bubblegum?",
      "Would you rather have to take a hot air balloon to get anywhere that’s too far away to walk or ride on a giant mountain goat?",
      "Would you rather sneeze out confetti or sprinkles?",
      "Would you rather have 200 toes or 200 fingers?",
      "Would you rather be able to snap your fingers and change your hair color in an instant or snap your fingers and change into any outfit you can imagine in an instant?",
      "Would you rather only be able to get around by hopping like a bunny or by slithering around like a snake?",
      "Would you rather be able to turn invisible by putting on a special invisibility hat or have a magic watch that freezes time whenever you press it?",
      "Would you rather live in an actual life-size gingerbread house or have a magical candy forest behind you with a chocolate creek and icing covered hills?",
      "Would you rather be able to walk on your elbows or balance and hop on your nose?",
      "Would you rather be able to change colors like a chameleon to blend into your surroundings or grow leaves all over your body to blend in with nature?",
      "Would you rather have a big huge inflatable bounce house that fits in your pocket so you can bring it with you wherever you go and it blows up by itself in just 10 seconds OR shoes that can make you bounce as high as a trampoline?",
      "Would you rather have the ability to expertly play any instrument you ever pick up or be incredible at any sport you ever try?",
      "Would you rather be able to speak and understand every language that exists in the world or magically find anything that’s lost within five minutes?",
      "Would you rather have to communicate for a day only in burps or in toots?",
      "Would you rather have to chew your way through a wall of cotton candy to get to the bathroom every time you have to go or dig through a wall of slime?",
      "Would you rather be able to juggle anything (like even 20 elephants) or be able to balance on anything and never ever fall (like even tightrope walk on a piece of floss!)",
      "Would you rather have to wear poop emoji tattoos on your cheeks or wear a poop emoji hat for a whole year?",
      "Would you rather have to swim through a pool of jello every morning for your exercise or sprint across a field full of slippery banana peels?",
      "Would you rather have to dress up like a giant pumpkin wherever you go or wear shoes carved out of real pumpkins (that you have to re-carve for yourself whenever they get moldy?)",
      "Would you rather be able to fly by flapping your ears or swim super fast by your feet automatically turning into flippers whenever they touch water?",
      "Would you rather have a magical fresh squeezed lemonade stand in your house that always has the most delicious, refreshing lemonade or a magical cookie cart that is always stocked with fresh-baked, warm, perfect cookies?",
      "Would you rather have to paint a whole mural but you can only use your toes to hold the paintbrush or have to sculpt a whole statue but it’s made out of cheese and you have to use your teeth?",
      "Would you rather never have to smell anything bad (like a fart, garbage, skunk) or have everything you ever eat taste amazing?",
      "Would you rather sweat out chocolate milk or have rainbow colored teeth?",
      "Would you rather have the ability to shrink down to the size of an ant or grow as big as a building?",
      "Would you rather have the ability to be as loud as a foghorn whenever you want or have a magical whisper that can be heard from miles away when you want it to?",
      "Would you rather have to start dancing automatically every time you hear music or start singing along automatically even if you don’t know the words or if it doesn’t have words?",
      "Would you rather have to live on a giant brownie for a day or live in a giant bowl of cereal for a day?",
      "Would you rather have magical armpits that start talking every time you lift your arms up or magical feet that start talking every time you take your socks and shoes off?",
      "Would you rather have long hair growing from your knees (like long enough to braid it) or growing from your elbows?",
      "Would you rather have to have a turtle shell or a snail shell attached to your back?",
      "Would you rather have a magic backpack that gives you two extra arms when you wear it or have magic pants that give you two extra legs?",
      "Would you rather have your bedroom walls made out of pizza or out of cake?",
      "Would you rather have a built-in trampoline mode in your feet that lets you jump like you’re on a trampoline or a built-in slide mode on your butt that lets you sit down and slide really fast to anywhere you want to go?",
      "Would you rather spend a day inside a snowglobe or spend a day inside a dollhouse?",
      "Would you rather only be able to talk like a pirate or have your accent randomly switch every day?",
      "Would you rather have four elbows or four knees?",
      "Would you rather have a carrot for a nose or a sausage for a nose?",
      "Would you rather have the ability to make any clothing item you see fit you perfectly (even if you’re a kid and it’s in a baby size or a grownup size) OR have your favorite outfits magically grow with you and always look brand new?",
      "Would you rather have a parrot on your shoulder ALL the time that always repeated everything you said in a loud obnoxious voice OR have a parrot on your shoulder all the time that could sing beautifully and wasn’t annoying but pooped on your shoulder every 15 minutes?",
      "Would you rather have a beard made out of spaghetti or a beard made out of sour gummy worms?",
      "Would you rather have a bunny tail (and you couldn’t cover it up with clothes, you’d have to have a little hole cut for it to stick out of) OR bunny ears that you COULD try to cover up with a hat but they pop out any time you take the hat off?",
      "Would you rather have jingle bells attached to your ears so every time you turn your head you jingle OR a rattle attached to your butt so whenever you walk or bounce you sound like a rattlesnake?",
      "Would you rather have your laugh sound like a donkey going HEE-HAW OR whenever you cry you actually sound like you’re just yelling 'Booo-HOOOO!!!'?",
      "Would you rather have a sneaky booger always hanging out of your nostril OR always have food stuck in your teeth?",
      "Would you rather have the power to turn any stinky smell into the smell of your choosing (like you can make your armpits or feet smell like pancakes) OR make any annoying sound into something better (like a jackhammer sound turn into a lullaby)?",
      "Would you rather have to eat a fish popsicle for dessert every night BUT your dinner is always new and exciting and yummy OR have to eat the same boring, bland dinner every night BUT your dessert is always new and amazing?",
      "Would you rather have to string every string cheese in the whole bag into an octopus shape before you can eat any of it OR the only way you can eat crackers is by balancing them on your nose and having to make them bounce into your mouth? (submitted by Nat 🥰)",
      "Would you rather have your bottom and face switched OR your feet and hands switched? (submitted by McKenna 🥰)",
      "Would you rather snap your finger to grow super tall like trees OR super small like bugs? (submitted by Maisie 🥰)",
      "Would you rather have to use toe nail clippings like salt OR ear wax like butter? (submitted by Jan… EWW, Jan!! 😂)",
      "Would you rather have lobster claws or bear paws?",
      "Would you rather be famous for doing the most incredible armpit-fart sounds OR be famous for having the world’s largest booger?",
      "Would you rather have to wear a giant cheeseburger-shaped hat every single day OR once a week wear a whole cheeseburger costume all day long?",
      "Would you rather have licorice for hair or a gumdrop as a nose?",
      "Would you rather have retractable claws like a cat OR a retractable monkey tail that can grab onto things and that you can hang from?",
      "Would you rather have shiny sequin-covered skin like a human disco ball OR have iridescent scales like a koi fish?"
    ];

    /* ---------- History + non-repeat shuffle (deck) + persistence ---------- */
    function hashText(text){
      let h = 0;
      for (let i = 0; i < text.length; i++) h = (h * 31 + text.charCodeAt(i)) >>> 0;
      return h.toString(36);
    }
    function shuffle(arr){
      for (let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    const KEYNS = 'wyr'; // namespace so it won't clash with other apps
    const KEY_VER   = `${KEYNS}_ver`;
    const KEY_ORDER = `${KEYNS}_order`;
    const KEY_INDEX = `${KEYNS}_idx`;
    const KEY_HIST  = `${KEYNS}_hist`;
    const KEY_HPOS  = `${KEYNS}_hpos`;
    const KEY_FAVS  = `${KEYNS}_favs`;

    const PROMPTS_VERSION = hashText(JSON.stringify(prompts));

    function freshOrder(avoidIdx){
      const order = shuffle(Array.from({length: prompts.length}, (_, i) => i));
      if (avoidIdx != null && prompts.length > 1 && order[0] === avoidIdx){
        const k = 1 + Math.floor(Math.random() * (order.length - 1));
        [order[0], order[k]] = [order[k], order[0]];
      }
      return order;
    }
    function saveState(s){
      localStorage.setItem(KEY_VER,   PROMPTS_VERSION);
      localStorage.setItem(KEY_ORDER, JSON.stringify(s.order));
      localStorage.setItem(KEY_INDEX, String(s.idx));
      localStorage.setItem(KEY_HIST,  JSON.stringify(s.history));
      localStorage.setItem(KEY_HPOS,  String(s.hpos));
    }
    function loadState(){
      const savedVer = localStorage.getItem(KEY_VER);
      let state = { order:null, idx:0, history:[], hpos:0 };
      if (savedVer === PROMPTS_VERSION){
        try{
          state.order   = JSON.parse(localStorage.getItem(KEY_ORDER) || 'null');
          state.idx     = parseInt(localStorage.getItem(KEY_INDEX) || '0', 10) || 0;
          state.history = JSON.parse(localStorage.getItem(KEY_HIST)  || '[]');
          state.hpos    = parseInt(localStorage.getItem(KEY_HPOS)   || String(state.history.length), 10) || state.history.length;
        }catch{}
      }
      if (!Array.isArray(state.order) || state.order.length !== prompts.length){
        state.order = freshOrder(null);
        state.idx = 0; state.history = []; state.hpos = 0;
      } else {
        state.idx  = Math.min(Math.max(0, state.idx),  Math.max(0, state.order.length-1));
        state.hpos = Math.min(Math.max(0, state.hpos), state.history.length);
        state.history = state.history.filter(n => Number.isInteger(n) && n>=0 && n<prompts.length);
      }
      saveState(state);
      return state;
    }

    let STATE = loadState();

    /* ---------- UI helpers ---------- */
    const elPrompt = document.getElementById('prompt');
    const btnBack  = document.getElementById('btnBack');
    const btnFwd   = document.getElementById('btnFwd');
    const btnNext  = document.getElementById('btnNext');
    const btnSave  = document.getElementById('btnSave');

    function show(idx){ elPrompt.textContent = prompts[idx]; }
    function updateNavButtons(){
      btnBack.disabled = STATE.hpos <= 1;
      btnFwd.disabled  = STATE.hpos >= STATE.history.length;
    }
    function currentIndex(){
      if (!STATE.history.length || STATE.hpos===0) return null;
      return STATE.hpos===STATE.history.length
        ? STATE.history[STATE.history.length-1]
        : STATE.history[STATE.hpos-1];
    }

    function pickNextFromDeck(){
      let { order, idx } = STATE;
      const next = order[idx];
      idx++;
      if (idx >= order.length){
        // avoid showing the same card twice in a row across cycles
        const avoid = next;
        order = freshOrder(avoid);
        idx = 0;
      }
      STATE.order = order;
      STATE.idx = idx;
      return next;
    }

    function next(){
      elPrompt.textContent = 'Here you go...!';
      setTimeout(()=>{
        if (STATE.hpos < STATE.history.length) STATE.history.splice(STATE.hpos);
        const pick = pickNextFromDeck();
        STATE.history.push(pick);
        if (STATE.history.length > 500) STATE.history.splice(0, STATE.history.length-500);
        STATE.hpos = STATE.history.length;
        show(pick);
        updateNavButtons();
        saveState(STATE);
        updateSaveButton();
      }, 350);
    }
    function back(){
      if (STATE.hpos > 1){
        STATE.hpos -= 1;
        show(STATE.history[STATE.hpos-1]);
        updateNavButtons();
        saveState(STATE);
        updateSaveButton();
      }
    }
    function forward(){
      if (STATE.hpos < STATE.history.length){
        const idx = STATE.history[STATE.hpos];
        STATE.hpos += 1;
        show(idx);
        updateNavButtons();
        saveState(STATE);
        updateSaveButton();
      }
    }

    /* ---------- Favorites ---------- */
    const favListEl  = document.getElementById('favList');
    const favEmptyEl = document.getElementById('favEmpty');
    const btnCopyAll = document.getElementById('btnCopyAll');
    const btnClear   = document.getElementById('btnClear');

    function loadFavorites(){
      try { return JSON.parse(localStorage.getItem(KEY_FAVS) || '[]'); }
      catch { return []; }
    }
    function saveFavorites(list){
      localStorage.setItem(KEY_FAVS, JSON.stringify(list));
    }
    let FAVORITES = loadFavorites(); // array of indices

    function isFavorite(i){ return FAVORITES.includes(i); }
    function updateSaveButton(){
      const i = currentIndex();
      if (i == null){ btnSave.disabled = true; btnSave.textContent = 'Save to Favorites'; return; }
      btnSave.disabled = false;
      btnSave.textContent = isFavorite(i) ? 'Saved' : 'Save to Favorites';
    }
    function saveCurrent(){
      const i = currentIndex();
      if (i == null) return;
      if (!isFavorite(i)){
        FAVORITES.push(i); saveFavorites(FAVORITES); renderFavorites();
        showToast('Saved to favorites'); updateSaveButton();
      } else {
        showToast('Already in favorites');
      }
    }
    function removeFavorite(i){
      FAVORITES = FAVORITES.filter(n => n !== i); saveFavorites(FAVORITES);
      renderFavorites(); updateSaveButton(); showToast('Removed');
    }
    function renderFavorites(){
      favListEl.innerHTML = '';
      if (!FAVORITES.length){ favEmptyEl.style.display = 'block'; return; }
      favEmptyEl.style.display = 'none';
      FAVORITES.forEach(i => {
        const li = document.createElement('li'); li.className = 'favItem';
        const txt = document.createElement('div'); txt.className = 'favText'; txt.textContent = prompts[i];
        const actions = document.createElement('div'); actions.className = 'favActions';
        const copyBtn = document.createElement('button'); copyBtn.className = 'iconBtn'; copyBtn.textContent='Copy';
        copyBtn.onclick = ()=>{ navigator.clipboard.writeText(prompts[i]); showToast('Copied'); };
        const delBtn  = document.createElement('button'); delBtn.className = 'iconBtn'; delBtn.textContent='Remove';
        delBtn.onclick = ()=> removeFavorite(i);
        actions.appendChild(copyBtn); actions.appendChild(delBtn);
        li.appendChild(txt); li.appendChild(actions); favListEl.appendChild(li);
      });
    }
    function copyFavorites(){
      if (!FAVORITES.length){ showToast('No favorites to copy'); return; }
      const text = FAVORITES.map(i => prompts[i]).join('\n');
      navigator.clipboard.writeText(text); showToast('Favorites copied');
    }
    function clearFavorites(){
      FAVORITES = []; saveFavorites(FAVORITES); renderFavorites(); updateSaveButton(); showToast('Favorites cleared');
    }

    /* ---------- Tiny toast ---------- */
    const toastEl = document.getElementById('toast');
    let toastTimer = null;
    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toastEl.classList.remove('show'), 1200);
    }

    /* ---------- Wire up ---------- */
    btnNext.addEventListener('click', next);
    btnBack.addEventListener('click', back);
    btnFwd .addEventListener('click', forward);
    btnSave.addEventListener('click', saveCurrent);
    btnCopyAll.addEventListener('click', copyFavorites);
    btnClear.addEventListener('click', clearFavorites);

    document.addEventListener('keydown', e => {
      if (e.key === 'Enter') next();
      if (e.key === 'ArrowLeft') back();
      if (e.key === 'ArrowRight') forward();
      if (e.key.toLowerCase() === 's') saveCurrent();
    });

    // On load: show last seen if exists
    if (STATE.history.length){
      STATE.hpos = STATE.history.length;
      show(STATE.history[STATE.history.length - 1]);
    }
    updateNavButtons();
    renderFavorites();
    updateSaveButton();
    saveState(STATE);
  </script>
</body>
</html>
